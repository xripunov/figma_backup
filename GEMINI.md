# Контекст проекта: Figma Backup Tool

Это десктопное приложение на Flutter для создания локальных резервных копий файлов из Figma.

## Технологический стек
- **Язык:** Dart
- **Фреймворк:** Flutter
- **Ключевые зависимости:**
  - `puppeteer`: для автоматизации браузера и скачивания файлов.
  - `provider`: для управления состоянием.
  - `file_picker`: для выбора директории сохранения.
  - `intl`: для форматирования дат.

## Структура проекта

- `lib/main.dart`: Точка входа в приложение.
- `lib/screens/`: UI-экраны приложения.
  - `home_screen.dart`: Главный экран. Здесь происходит управление группами и списками файлов для бэкапа.
  - `backup_screen.dart`: Экран, который отображает прогресс скачивания файлов в реальном времени.
  - `settings_screen.dart`: Экран для управления настройками, такими как API токен Figma и путь для сохранения файлов.
- `lib/services/`: Сервисы, инкапсулирующие основную бизнес-логику.
  - `figma_api_service.dart`: Отвечает за взаимодействие с официальным API Figma для получения метаданных файлов (имя, проект, дата изменения).
  - `puppeteer_service.dart`: **Ключевой и самый сложный сервис.** Управляет запуском headless-браузера (Chromium), автоматической авторизацией в Figma и непосредственно скачиванием `.fig` файлов через эмуляцию действий пользователя.
  - `settings_service.dart`: Управляет сохранением и загрузкой настроек пользователя (API токен, группы файлов, путь сохранения) в локальное хранилище.
- `lib/models/`: Модели данных, описывающие сущности проекта (FigmaFile, BackupGroup, BackupItem, BackupTask).

## Основная логика работы
1.  Пользователь добавляет файлы Figma по URL на `home_screen`.
2.  `figma_api_service` использует токен пользователя для получения информации о файле.
3.  При запуске процесса бэкапа, управление передается в `backup_screen`.
4.  `puppeteer_service` запускает браузер в фоновом (headless) режиме.
5.  Сервис проверяет наличие активной сессии в Figma. Если ее нет, он открывает видимый браузер и просит пользователя войти в аккаунт.
6.  После успешной авторизации, сервис последовательно открывает страницы каждого файла и инициирует скачивание "локальной копии" (`.fig`).
7.  Скачанные файлы перемещаются из системной папки "Загрузки" в целевую директорию, указанную пользователем, и раскладываются по папкам в соответствии с названием проекта в Figma. Файлы без проекта сохраняются в папку `Drafts`.

## Пользовательские инструкции
- Отвечать на русском языке.
- Перед созданием коммита спрашивать у пользователя сообщение коммита.
- Не отправлять изменения в Git (`git push`) без явной команды пользователя.
